\chapter*{Введение}
\addcontentsline{toc}{chapter}{Введение}

В настоящее время вычислительная техника широко применяется для симуляции разнообразных природных феноменов. Создано множество математических моделей, предназначенных для изучения, предсказания или обучения специалистов взаимодействию с различными явлениями. Достаточно часто, для построения качественной вычислительной модели и ее компьютерной реализации, требуется найти представление для трехмерных тел со сложной геометрической формой и топологией, которые, к тому же, могут существенно изменяться в процессе проведения вычислительного эксперимента.

Примерами приложений, работающих с такими объектами, являются:
\begin{itemize}
\item симуляторы эрозионных \cite{erosion} или агрегационных процессов,
\item приложения для обработки данных компьютерной томографии,
\item хирургические симуляторы \cite{surgery},
\item программы трехмерного моделирования, реализующие технологии виртуального скульптурирования \cite{sculpt}, такие, как \emph{Z-Brush} или \emph{3D Coat}.
\end{itemize}

Многие из этих приложений требуют интерактивности с пользователем при визуализации и редактировании трехмерной сцены. Так же можно упомянуть игровые приложения, так как в последние несколько лет именно они адаптируют самые свежие разработки в области интерактивной трехмерной графики.

Разработаны различные подходы к машинному представлению трехмерных объектов, и структуры данных, их реализующие\cite{graphics_gems}. Наиболее распространенным представлением 3D геометрии в современных интерактивных приложениях является полигональное. При таком подходе поверхности объектов аппроксимируются множеством многоугольников (чаше всего треугольниками или четырехугольниками). Этот подход обладает большим количеством достоинств. В частности, современные графические ускорителе позволяют в реальном времени визуализировать сцены, состоящие их миллионов треугольников. Создано огромное количество алгоритмов работы с полигональными 3D моделями. Разработаны структуры данных, поддерживающие эффективные операции перечисления, удаления и добавления примитивов в полигональную сетку\cite{halfedge}.

Несмотря на все преимущества, полигональный подход не лишен недостатков. Например, операции редактирования, изменяющие топологию объектов, и структуры данных, поддерживающие такие операции, реализуются, как правило, достаточно нетривиально и, в случае сложной геометрии объектов, могут быть слишком трудоемкими для интерактивных приложений.

Помимо полигонального, существуют и развиваются другие методы представления трехмерных объектов. Например, воксельное представление и представление облаками точек \cite{point_cloud} (\emph{point cloud}). Воксельное представление 3D объектов часто используется в научной и медицинской графике для представления результатов томографических сканирований или результатов вычислительных экспериментов.

Воксельная сцена представляет собой регулярную трехмерную решетку кубических вокселей. Таким образом, воксели можно считать трехмерным расширением пикселей, составляющих двухмерные растровые изображения. Каждый воксель хранит специфичную для приложения характеристику занимаемого им пространства. Таким характеристиками могут быть: цвет, прозрачность, плотность, температура и т.д. Одним из недостатков такого подхода являются очень высокие требования к памяти. Объем памяти, требуемой для хранения кубического объема с разрешением $n$ вокселей на каждое измерение, пропорционален $O(n^3)$.

Часто представляют интерес не все воскели занимаемого объектом объема. Например, иногда достаточно хранить только воксели, аппроксимирующие поверхность моделируемого объекта. В этом случае количество хранимых вокселей растет с увеличением разрещения со пропорционально $O(n^D)$, где $D$ --- фрактальная размерность\cite{mandel} исследуемого объекта.

Однако, для хранения только избранных вокселей требуется некая разреженная труктура данных. Такие структуры можно разделить на:
\begin{itemize}
\item иерархические решетки и деревья (KD, октарное дерево и т.д.) \cite{gpu_octree},
\item пространственные хэши \cite{gpu_hash},
\item использующие алгоритмы сжатия, например RLE \cite{voxel_rle}.
\end{itemize}

Одним из преимуществ воксельного представления трехмерных сцен является сравнительная простота внесения в сцену локальных изменений геометрии и топологии. Операции редактирования схожи с редактированием двухмерных растровых изображений. Редактирование сцены, упакованной в октарное дерево так же достаточно легко в реализации. Например, операции объединения пересечения или вычитания объектов эффективно выполняются при помощи логических операций над поддеревьями. В данной работе было реализовано разреженное воксельное октарное дерево (SVO)\cite{svo_olick}, интерактивное внесение изменений в которое осуществляется средствам CPU компьютера.

За последние несколько лет резко выросла производительность графических ускорителей (далее \emph{GPU}, \emph{Graphics Processing Unit}) современных компьютеров. Также значительно увеличилась их функциональность. Ранее ускорители могли использовать ограниченное, жестко заданное производителем и стандартами множество методов преобразования координат, расчета освещения, наложения текстур и т.д. Теперь же стало возможным программирование различных этапов построения изображения. Благодаря этому появилось много новых графических эффектов, которые мы видим в современных компьютерных играх. Это новые методы построения теней, процедурная генерация геометрии и текстур, волны на поверхности воды, отражения, преломление лучей и т.д. Ещё одним заметным усовершенствованием \emph{GPU} стала поддержка чисел с плавающей точкой для представления изображений. В графике эта возможность используется в основном для построения \emph{HDR}\footnote{\emph{High dynamic range} (Расширенный динамический диапазон)}-изображений и сохранении промежуточных результатов в многопроходных алгоритмах.

\emph{GPU} изначально были ориентированы на хорошо распараллеленные высокопроизводительные вычисления. К тому же они хорошо распространены и относительно недороги. Из-за этого на них обратили внимание инженеры и ученые, которым необходимо выполнять объемные расчеты для обработки результатов экспериментов, моделирования физических процессов. Оказалось, что дешевые \emph{GPU} иногда даже превосходят по эффективности дорогие специализированные вычислители, заточенные под конкретную задачу. Так же нетрадиционным применением графических ускорителей заинтересовались разработчики игр, применившие их не только для графических эффектов, но и для расчетов игровой физики или искусственного интеллекта в реальном времени.

Так появился термин \emph{GPGPU} (\emph{General-Purpose computation on GPU}), обозначающий «непрофильное» использование \emph{GPU} для решения слабо связанных традиционной интерактивной графикой задач. Ускоритель в данном случае используется в качестве потокового вычислителя с большим количеством параллельно работающих процессоров.

Приложение может использовать вычислительные мощности \emph{GPU} различными способами. Традиционным является способ, когда при реализации алгоритма программист оперирует непосредственно с графическим \emph{API} и описывает отдельные шаги алгоритма виде небольших программных шейдеров. Однако, этот подход не очень удобен из-за того, что программисту нужно изучать особенности графических \emph{API} (\emph{OpenGL} или \emph{Direct3D}) и специальные языки, которые в них используются для написания кода, выполняющегося на видеокарте (\emph{GLSL}, \emph{Cg}\cite{cg:2005}, \emph{HLSL}).

Для того, чтобы упростить разработку \emph{GPGPU}-приложений, было создано несколько библиотек, которые скрывали от пользователя тонкости работы с \emph{GPU}, выставляя наружу интерфейсы для выполнения различных операций над массивами данных, например, операций линейной алгебры, таких как умножение матриц или решение систем уравнений. Примерами таких библиотек являются \emph{BrookGPU}\footnote{\url{http://graphics.stanford.edu/projects/brookgpu/}} и \emph{RapidMind}\footnote{\url{http://www.rapidmind.net}}.

Производители видеокарт, заметив интерес к необычным применениям своей продукции, создали свои средства для создания \emph{GPGPU}-приложений. Одной из первых стала доступной технология компании \emph{NVIDIA} \emph{CUDA}\footnote{\emph{Compute Unified Device Architecture}}. Затем появились схожие с ней технологии \emph{OpenCL} и \emph{DirectCompute}, поддерживаемые различными производителями. Использование этих средств позволяет снять некоторые принципиальные ограничения, накладываемые графическими \emph{API} и более гибко и эффективно использовать ресурсы видеокарты.

В данной работе для ускорения некоторых вычислений используется технология CUDA компании NVIDIA. В частности, она используется для визуализации сцены, представленной октарным воксельным деревом, при помощи обратной трассировки лучей.

В работе рассмотрены некоторые особенности, которые следует учитывать при переносе вычислений на GPU при помощи технологии CUDA. В частности, выполнена оценка эффективности работы встроенного планировщика заданий.
